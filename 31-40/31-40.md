31. 

32. 只是记录最大的匹配长度，不算特别难，主要在栈操作多加一个存储单位来存储当前该字符后最多匹配的括号对数，也就是说，当字符为`(`则自动入栈，同时分配数字0表示当前字符后有0个括号对匹配成功；当字符为`)`则分成两种情况，若弹出的元素为`(`，则认为是匹配成功，向栈顶元素中的数值加上当前弹出数值再加1，表示栈顶元素匹配的对数为弹出匹配对数加上弹出元素本身，若弹出的元素为字符串初始符号`#`，则认为该`)`是错误符号，需要清除栈，并记录`#`对应的数值表示错误符号前的最大匹配对数（这里，`(`不可能是错误符号，它只可能是待匹配符号）。最后遍历完毕后，依次弹出栈，直至清空，记录最大数值，最后乘以2返回，即为所要求数值。

33. 